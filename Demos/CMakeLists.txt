#TODO: This will be automatically generated by the editor, and also probably will run from the editor (need to embed cmake)

file(GLOB_RECURSE DEMOS_SOURCE_FILES 
${CMAKE_CURRENT_SOURCE_DIR}/*.h 
${CMAKE_CURRENT_SOURCE_DIR}/*.c
${CMAKE_CURRENT_SOURCE_DIR}/*.hpp 
${CMAKE_CURRENT_SOURCE_DIR}/*.cpp)

# Organize the files in folders according to the organization in the file systems
macro(GroupSources curdir)

   file(GLOB children RELATIVE ${CMAKE_CURRENT_SOURCE_DIR}/${curdir} ${CMAKE_CURRENT_SOURCE_DIR}/${curdir}/*)

   foreach(child ${children})

          if(IS_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/${curdir}/${child})

				GroupSources(${curdir}/${child})

          else()

				string(REPLACE "/" "\\" groupname ${curdir})
				
				string(REPLACE "." "Sources" groupname ${groupname})

            source_group(${groupname} FILES ${CMAKE_CURRENT_SOURCE_DIR}/${curdir}/${child})

          endif()

   endforeach()

endmacro()

GroupSources(./)

if(MSVC)
    add_definitions(/FI"${CMAKE_CURRENT_SOURCE_DIR}/GeneratedProjectDefinition.h")
else()
    # GCC or Clang
    add_definitions(-include ${CMAKE_CURRENT_SOURCE_DIR}/GeneratedProjectDefinition.h)
endif()

include_directories(
${CMAKE_CURRENT_SOURCE_DIR} 
${COMMON_INCLUDE_DIR}
${glm_INCLUDE_DIR}
${PROJECT_SOURCE_DIR}/Engine
)

add_library(BLADemos SHARED ${DEMOS_SOURCE_FILES})
target_link_libraries(BLADemos BLAEngine)

set_target_properties(BLADemos
  PROPERTIES
  RUNTIME_OUTPUT_DIRECTORY "${PROJECT_SOURCE_DIR}/Cooked/Libraries/Release" #TODO: Set according to configuration
)

if(WIN32)
	set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} /SUBSYSTEM:WINDOWS")
endif()